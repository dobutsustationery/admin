# Visual Regression Testing

This directory contains baseline screenshots for visual regression testing of the inventory page.

## Baseline Screenshot

The baseline screenshot (`inventory-Inventory-Page-should-match-visual-snapshot-chromium.png`) captures the inventory page in its expected state, showing the "Sign In" button when Firebase emulators are running.

This screenshot was generated by:
1. Starting Firebase emulators (Firestore on port 8080, Auth on port 9099)
2. Building the application in emulator mode
3. Navigating to `/inventory` route
4. Capturing full-page screenshot showing the authentication UI


## How it Works

1. **Baseline Screenshots**: The first time a visual test runs (or after updating baselines), Playwright captures a screenshot and saves it as the baseline.

2. **Comparison**: On subsequent runs, Playwright compares the current screenshot with the baseline:
   - If they match (within tolerance), the test passes
   - If they differ, the test fails and generates diff images

3. **Manual Review Required**: When a visual test fails:
   - Review the diff images in the test results (`test-results/*-diff.png`)
   - If the change is intentional, update the baseline
   - If the change is a bug, fix the code

## Updating Baselines

When you intentionally change the UI and need to update the baseline:

```bash
# Update all baselines
npx playwright test --update-snapshots

# Update specific test baseline  
npx playwright test inventory.spec.ts --update-snapshots

# Or use the helper script
bash e2e/generate-baselines.sh
```

## Files

- `inventory-Inventory-Page-should-match-visual-snapshot-chromium.png` - Baseline screenshot for the main inventory page test

## Tolerance Settings

Visual comparison is configured in `playwright.config.ts`:
- `maxDiffPixelRatio: 0.01` - Maximum 1% of pixels can differ
- `threshold: 0.2` - Per-pixel color difference threshold (0-1, higher = more tolerant)

These settings allow for minor rendering differences while catching significant visual regressions.

## In CI/CD

The GitHub Actions workflow automatically:
1. Runs visual regression tests
2. Detects when screenshots don't match baseline
3. Uploads diff images as artifacts for review
4. Fails the build if visual changes are detected

This ensures all UI changes require explicit approval before merging.
